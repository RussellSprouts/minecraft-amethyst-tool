'use strict';(0,ub)();(0,yc)();(0,function(){for(const a of document.getElementsByClassName("file-select")){const b=(0,kb)(a.querySelector("span"),HTMLSpanElement),c=(0,kb)(a.querySelector("input"),HTMLInputElement),d=b.textContent;c.addEventListener("change",()=>{c.files&&0!==c.files.length?b.textContent=1===c.files.length?"1 file selected.":`${c.files.length} files selected.`:b.textContent=d})}})();const fd=[{x:0,z:0}];
function gd(a){return(a=a.match(/.*r\.(-?[0-9]+)\.(-?[0-9]+)\.mca$/))?{x:parseInt(a[1]),z:parseInt(a[2])}:{x:Infinity,z:Infinity}}const hd=(0,y)("#afk-spot-log"),id=(0,y)("#region-files",HTMLInputElement);function jd(a){return"string"===typeof a?a.replace(/^.*\/([^/]+)$/,"$1"):a.name}
async function kd(a){function b(...q){console.log(...q);q=q.map(z=>z?z.toString():"");hd.textContent=q.join("\t")+"\n"}function c(q,z,x,k){const m=(0,t)(q,0,z);e[m]||(e[m]={});e[m][k]=(e[m][k]??0)+x;e[m][k]>(d[m]??-1)&&(d[m]=e[m][k],"purple"!==Ec(u,q,z)&&(x=Math.floor(256*(1-e[m][k]/1E3)),x=0>x?"#000000":16>x?`0${x.toString(16)}`:x.toString(16),Dc(u,q,z,`#${x}${x}${x}`)));e[m][k]>r&&(r=e[m][k],D=k,console.log(`New best ${m} ${r} ${D}`))}const d={},e={},f={};var g=(0,y)("#step-1-response"),h=(0,y)("#step-1-response-balloon"),
l=(0,y)("#step-2");g.classList.add("hidden");l.classList.add("hidden");hd.textContent="";if(0!==a.length){h.textContent=`Selected ${a.length} files.`;g.classList.remove("hidden");l.classList.remove("hidden");var v=(0,y)("#map-label"),u=new Fc("#map");u.addEventListener("mousemove",(q,z)=>{const x=e[(0,t)(q,0,z)]??{};let k=-1,m=(0,t)(0,0,0);for(const [B,F]of Object.entries(x))F>k&&(k=F,m=B);const [n,,C]=(0,G)(m);v.textContent=`x:${n} z:${C} afk:${k} chunk:${f[(0,t)(q,0,z)]??"0"}`});a.sort((q,z)=>{q=
gd(jd(q));z=gd(jd(z));return q.x*q.x+q.z*q.z-(z.x*z.x+z.z*z.z)});var r=-1,D=(0,t)(0,0,0);b(`Processing ${a.length} region files...`);g=0;for(const q of a){const [z,,x]=(0,G)(D);b(`Processing ${jd(q)} (${Math.floor(g/a.length*100)}% overall)\nAFK at x:${z} z:${x} to have ${r} budding amethyst in range.`);g++;try{if(0===("string"===typeof q?NaN:q.size)){b("  (Skipping empty region)");continue}jd(q).endsWith(".mca")||b("  (Skipping unknown file type)");const k=await (0,ib)(q).promise;Object.assign(f,
k);for(const [m,n]of Object.entries(k)){const [C,,B]=(0,G)(m);0<n?Dc(u,C,B,"purple"):Ec(u,C,B)===u.C&&Dc(u,C,B,"aliceblue");u.u=!0;if(0<n)for(h=-8;8>=h;h++)for(l=-8;8>=l;l++)for(const {x:F,z:R}of fd){const V=l+.5+F,Z=h+.5+R;64>V*V+Z*Z&&c(C+l,B+h,n,(0,t)(16*(C+l+F),0,16*(B+h+R)))}}}catch(k){b("Error:",k),console.log(k)}}var [K,,A]=(0,G)(D);Dc(u,Math.floor(K/16),Math.floor(A/16),"gold");b(`Processing finished (100% overall).\nAFK at x:${K.toFixed(2)} z:${A.toFixed(2)} to have ${r} budding amethyst in range.`)}}
id.addEventListener("change",async()=>{kd(Array.from(id.files??[]))});(0,y)("#sample").addEventListener("click",()=>{kd(["../samples/r.0.0.mca","../samples/r.0.-1.mca","../samples/r.-1.-1.mca","../samples/r.-1.0.mca"])});
//# sourceMappingURL=geode.js.map
