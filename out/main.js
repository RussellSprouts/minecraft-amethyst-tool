'use strict';function db(a){return new ma(a.start-1,a.end+1,a.i)}function eb(a){return new ma(a.end-1,a.start-1,-a.i)}function fb(a,b){return"*"===a?"*":Array.isArray(a)?a[0]:a["*"]?a["*"]:a[b]??"*"}function gb(a,b,c){if(!a)throw Error(`${b}\n${c}`);}function hb(a){throw Error(`Unexpected case: ${a}`);}
function ib(a,b){if(a.i+b>a.data.byteLength){for(var c=2*a.data.byteLength;a.i+b>c;)c*=2;b=new DataView(new ArrayBuffer(c));for(c=0;c<a.data.byteLength;c++)b.setInt8(c,a.data.getInt8(c));a.data=b}}function jb(a,b){ib(a,1);a.data.setInt8(a.i,b);a.i++}function kb(a,b){ib(a,4);a.data.setInt32(a.i,b);a.i+=4}function lb(a,b){b=da.encode(b);ib(a,b.byteLength+2);a.data.setUint16(a.i,b.byteLength);a.i+=2;for(let c=0;c<b.byteLength;c++)a.data.setUint8(a.i+c,b[c]);a.i+=b.byteLength}
function mb(a,b,c){c=Math.floor(b.byteLength/c);ib(a,b.byteLength+4);a.data.setInt32(a.i,c);a.i+=4;for(c=0;c<b.byteLength;c++)a.data.setUint8(a.i+c,b.getUint8(c));a.i+=b.byteLength}class nb{constructor(){this.i=0;this.data=new DataView(new ArrayBuffer(1024))}}function ob(a){a.i+=1;return a.data.getInt8(a.i-1)}function pb(a){a.i+=4;return a.data.getInt32(a.i-4)}function qb(a){const b=a.data.getUint16(a.i);a.i+=2;const c=0===b?"":ca.decode(new DataView(a.data.buffer,a.i,b));a.i+=b;return c}
function rb(a,b){const c=pb(a);b=new DataView(a.data.buffer,a.i,c*b);a.i+=b.byteLength;return b}class sb{constructor(a){this.data=a;this.i=0}}
function tb(a,b,c,d,e){switch(c){case 0:break;case 1:return ub(d,"byte",e),ob(b);case 2:return ub(d,"short",e),b.i+=2,b.data.getInt16(b.i-2);case 3:return ub(d,"int",e),pb(b);case 4:return ub(d,"long",e),b.i+=8,b.data.getBigInt64(b.i-8);case 5:return ub(d,"float",e),b.i+=4,b.data.getFloat32(b.i-4);case 6:return ub(d,"double",e),b.i+=8,b.data.getFloat64(b.i-8);case 8:return ub(d,"string",e),qb(b);case 7:return ub(d,"byteArray",e),rb(b,1);case 11:return ub(d,"intArray",e),rb(b,4);case 12:return ub(d,
"longArray",e),rb(b,8);case 10:vb(d,e);c={};for(var f;0!==(f=ob(b));){var k=qb(b);f=tb(a,b,f,fb(d,k),`${e}.${k}`);if("*"===d||d["*"]||k in d)c[k]=f}return c;case 9:gb("*"===d||Array.isArray(d),`Found a list, but expected ${d}`,e);c=ob(b);k=pb(b);f=[];for(let l=0;l<k;l++)f.push(tb(a,b,c,fb(d,0),`${e}[${l}]`));return f;default:hb(c)}}function ub(a,b,c){gb("*"===a||a===b,`Found a ${b}, but expected ${a}`,c)}
function vb(a,b){gb("*"===a||!Array.isArray(a)&&"object"===typeof a,`Found a compound, but expected ${a}.`,b)}function wb(a,b){gb("object"===typeof a,`Expected an object, got ${a}`,b);return a}
function xb(a,b,c,d,e){switch(d){case "byte":jb(b,yb(c,e));break;case "short":a=yb(c,e);ib(b,2);b.data.setInt16(b.i,a);b.i+=2;break;case "int":kb(b,yb(c,e));break;case "long":gb("bigint"===typeof c,`Expected a bigint, got ${c}`,e);ib(b,8);b.data.setBigInt64(b.i,c);b.i+=8;break;case "float":a=yb(c,e);ib(b,4);b.data.setFloat32(b.i,a);b.i+=4;break;case "double":a=yb(c,e);ib(b,8);b.data.setFloat64(b.i,a);b.i+=8;break;case "byteArray":mb(b,zb(c,e),1);break;case "intArray":mb(b,zb(c,e),4);break;case "longArray":mb(b,
zb(c,e),8);break;case "string":gb("string"===typeof c,`Expected a string, got ${c}`,e);lb(b,c);break;case "end":break;case "*":gb(!1,`Can't write value of unknown type: ${c}`,e);break;default:if(Array.isArray(d)){[d]=d;gb(Array.isArray(c),`Expected an array, got ${c}`,e);jb(b,Ab(d));kb(b,c.length);var f=0;for(var k of c)xb(a,b,k,d,`${e}[${f++}]`)}else if("object"===typeof d){vb(d,e);c=wb(c,e);k=Object.keys(c).sort();for(f of k)k=fb(d,f),jb(b,Ab(k)),lb(b,f),xb(a,b,c[f],k,`${e}.${f}`);jb(b,0)}else hb(d)}}
function yb(a,b){gb("number"===typeof a,`Expected a number, got ${a}`,b);return a}function zb(a,b){gb(a instanceof DataView,`Expected a DataView, got ${a}`,b);return a}
function Ab(a){switch(a){case "byte":return 1;case "short":return 2;case "int":return 3;case "long":return 4;case "float":return 5;case "double":return 6;case "byteArray":return 7;case "intArray":return 11;case "longArray":return 12;case "string":return 8;case "end":return 0;case "*":return 0;default:if(Array.isArray(a))return 9;if("object"===typeof a)return 10;hb(a)}}
var Bb=class{constructor(a){this.i=a}parse(a){a=new DataView(a.buffer,a.byteOffset,a.byteLength);a=new sb(a);gb(10===ob(a),"Expected a compound at root");gb(""===qb(a),"Expected an empty name at root");return tb(this,a,10,this.i,"root")}};function H(a,b,c){return`${a}:${b}:${c}`}function Cb(a){return a.split(":").map(b=>+b)}
var Db=class{constructor(){this.segments={};this.v=1E100;this.D=-1E100;this.B=1E100;this.F=-1E100;this.C=1E100;this.G=-1E100}get i(){return 1E100===this.v?{v:0,D:0,B:0,F:0,C:0,G:0}:{v:this.v,D:this.D,B:this.B,F:this.F,C:this.C,G:this.G}}get width(){return 1E100===this.v?1:this.D-this.v+1}get height(){return 1E100===this.B?1:this.F-this.B+1}get length(){return 1E100===this.C?1:this.G-this.C+1}get(a,b,c){var d=Math.floor(a/16);const e=Math.floor(b/16),f=Math.floor(c/16);a=(a%16+16)%16;b=(b%16+16)%16;
c=(c%16+16)%16;d=(0,H)(d,e,f);return this.segments[d]?this.segments[d][a+16*(c+16*b)]:0}set(a,b,c,d){this.D=Math.max(this.D,a);this.F=Math.max(this.F,b);this.G=Math.max(this.G,c);this.v=Math.min(this.v,a);this.B=Math.min(this.B,b);this.C=Math.min(this.C,c);var e=Math.floor(a/16);const f=Math.floor(b/16),k=Math.floor(c/16);a=(a%16+16)%16;b=(b%16+16)%16;c=(c%16+16)%16;e=(0,H)(e,f,k);this.segments[e]||(this.segments[e]=new Uint16Array(4096));this.segments[e][a+16*(c+16*b)]=d}},Eb={Version:"int",MinecraftDataVersion:"int",
Metadata:{Name:"string",Author:"string",Description:"string",EnclosingSize:{x:"int",y:"int",z:"int"},TimeCreated:"long",TimeModified:"long",TotalBlocks:"int",TotalVolume:"int",RegionCount:"int"},Regions:{"*":{BlockStatePalette:[{Name:"string",Properties:{"*":"string"}}],BlockStates:"longArray",Position:{x:"int",y:"int",z:"int"},Size:{x:"int",y:"int",z:"int"},Entities:[{"*":"*"}],TileEntities:[{"*":"*"}],PendingBlockTicks:[{"*":"*"}]}}};
function Fb(a,b,c,d){return 0>b||b>=a.width||0>c||c>=a.height||0>d||d>=a.length?"minecraft:air":a.j[a.u[b+a.width*(d+a.length*c)]]}
var Gb=class{constructor(a){this.A=new Bb(Eb);a=ha.ungzip(new Uint8Array(a));this.i=this.A.parse(a);a=Object.keys(this.i.Regions);1!==a.length&&console.warn("SchematicReader only supports a single region for now.");this.H=a[0];a=this.i.Regions[this.H];this.j=a.BlockStatePalette.map(ia);const b=BigInt(Math.max(Math.ceil(Math.log2(this.j.length)),2)),c=(1n<<b)-1n,d=this.width=Math.abs(a.Size.x),e=this.height=Math.abs(a.Size.y),f=this.length=Math.abs(a.Size.z);this.u=new Uint16Array(d*e*f);let k=0n;
for(let u=0;u<e;u++)for(let B=0;B<f;B++)for(let D=0;D<d;D++){var l=Number(k/64n*8n);const F=a.BlockStates.getBigUint64(l);l=((l+8<a.BlockStates.byteLength?a.BlockStates.getBigUint64(l+8):0n)<<64n)+F;this.u[D+d*(B+f*u)]=Number(l>>k%64n&c);k+=b}}get version(){return this.i.Version}get name(){return this.i.Metadata.Name}get description(){return this.i.Metadata.Description}},Hb=class{constructor(){this.name="schematic";this.u=new Bb(Eb);this.description="";this.j={"minecraft:air":0};this.i=["minecraft:air"];
this.canvas=new Db;this.version=5}};function Ib(a,b){if(a[b])return a[b];const c=b.indexOf("[");return-1!==c?a[b.slice(0,c)]??a["default"]:a["default"]}function Jb(a){a.K||(a.K=!0,requestAnimationFrame(()=>a.render()))}function U(a,b,c,d,e){const f=(0,H)(b,c,d);if(a.i[f]!==e&&(a.i[f]=e,a.u[f]&&a.j.remove(a.u[f]),a.u[f]=void 0,"minecraft:air"!==e&&"minecraft:cave_air"!==e)){const k=new m.Mesh(Ib(Ra,e),Ib(Qa,e));k.position.set(b,c,d);k.setRotationFromEuler(Ib(cb,e));a.u[f]=k;a.j.add(k)}}
var Kb=class extends EventTarget{constructor(){super();this.i={};this.u={};this.K=!1;const a=document.querySelector("#c");this.A=new m.WebGLRenderer({canvas:a});this.H=new m.Vector2;a.addEventListener("mousemove",c=>{const d=a.getBoundingClientRect();this.H.x=(c.clientX-d.left)/a.clientWidth*2-1;this.H.y=2*-((c.clientY-d.top)/a.clientHeight)+1;Jb(this)});this.S=new m.Raycaster;var b=new m.Scene;b.background=new m.Color("lightblue");this.R=new m.DirectionalLight(7829367);this.R.position.set(0,1,0);
b.add(this.R);this.O=new m.DirectionalLight(4473924);this.O.position.set(1,0,0);b.add(this.O);this.M=new m.DirectionalLight(4473924);this.M.position.set(-1,0,0);b.add(this.M);this.P=new m.DirectionalLight(2236962);this.P.position.set(0,0,1);b.add(this.P);this.N=new m.DirectionalLight(2236962);this.N.position.set(0,0,-1);b.add(this.N);this.U=new m.AmbientLight(8947848);b.add(this.U);this.j=b;this.camera=new m.PerspectiveCamera(75,2,.1,1E3);b=new oa.OrbitControls(this.camera,a);b.update();b.minDistance=
1;b.maxDistance=100;this.L=b;b.addEventListener("change",()=>Jb(this));window.addEventListener("resize",()=>Jb(this));this.render()}render(){this.K=!1;var a=this.A.domElement,b=a.clientWidth,c=a.clientHeight;(a=a.width!==b||a.height!==c)&&this.A.setSize(b,c,!1);a&&(b=this.A.domElement,this.camera.aspect=b.clientWidth/b.clientHeight,this.camera.updateProjectionMatrix());this.S.setFromCamera(this.H,this.camera);for(var d of this.j.children)d.visible=!0;d=this.S.intersectObjects(this.j.children);for(var e of d){d=
e.object.position.x|0;b=e.object.position.y|0;a=e.object.position.z|0;e=this.dispatchEvent;c=CustomEvent;var f=d;var k=b,l=a;f=this.i[(0,H)(f,k,l)]??"minecraft:air";e.call(this,new c("hover",{detail:{x:d,y:b,z:a,J:f}}));break}this.L.update();this.A.render(this.j,this.camera)}};function Lb(a,b){const c=document.createElement("a");c.href=a;c.download=b;c.style.display="none";document.body.appendChild(c);c.click();c.remove()}
function Mb(a,b,c="application/octet-stream"){const d=window.URL.createObjectURL(new Blob([a],{type:c}));Lb(d,b);setTimeout(()=>window.URL.revokeObjectURL(d),1E3)}function Nb(a){return new Promise((b,c)=>{const d=new FileReader;d.addEventListener("load",()=>{b(new Uint8Array(d.result))});d.addEventListener("error",()=>{c(d.error)});d.addEventListener("abort",()=>{c(Error("load aborted"))});d.readAsArrayBuffer(a)})};console.log("EXPECTED OUTPUT PER HOUR",4096/3/.2*6*35.2/72E3);function Ob(a,b,c){b=4*((b&31)+32*(c&31));return 0>=a.i.getUint8(b+3)?-1:4096*(a.i.getUint32(b)>>8)}
function Pb(a){const b={};for(let e=0;32>e;e++)for(let f=0;32>f;f++){var c=Ob(a,e,f);if(!(0>c)){var d=a.i.getUint32(c);a.i.getUint8(c+4);c=new Uint8Array(a.i.buffer,c+5,d-1);c=ha.ungzip(c);c=(new Bb(Qb)).parse(c);c=new Rb(c);d=0;for(const k of c.j){const l=k.j.indexOf("minecraft:budding_amethyst");if(-1!==l)for(let u=0;16>u;u++)for(let B=0;16>B;B++)for(let D=0;16>D;D++)Sb(k,D,u,B)===l&&d++}0<d&&(b[(0,H)(c.u,0,c.A)]=d)}}return b}
function Tb(a,b,c,d,e){if(!a.j[`${b}:${c}`]&&(b=Ob(a,b,c),-1!==b)){c=a.i.getUint32(b);a.i.getUint8(b+4);a=new Uint8Array(a.i.buffer,b+5,c-1);performance.mark("a");a=ha.ungzip(a);b=new Bb(Qb);performance.mark("b");performance.measure("unzip","a","b");a=b.parse(a);a=new Rb(a);performance.mark("c");performance.measure("nbt-parse","b","c");for(const k of a.j){a=k.j;for(const l of a)d.add(l);for(b=0;16>b;b++)for(c=0;16>c;c++)for(let l=0;16>l;l++){var f=Sb(k,l,b,c);f=a[f];e.set(f,(e.get(f)??0)+1)}}performance.mark("d");
performance.measure("decode","c","d")}}var Ub=class{constructor(a){this.i=a;this.j={}}};const Vb={Y:"byte",block_states:{data:"longArray",palette:[{Name:"string",Properties:{"*":"string"}}]},BlockStates:"longArray",Palette:[{Name:"string",Properties:{"*":"string"}}]},Qb={DataVersion:"int",sections:[Vb],xPos:"int",zPos:"int",Level:{xPos:"int",zPos:"int",Status:"string",Sections:[Vb]}};
class Rb{constructor(a){this.data=a;this.j=this.data?.["sections"]?.map(b=>new Wb(this.i,b))??this.data?.["Level"]?.["Sections"]?.map(b=>new Wb(this.i,b))??[]}get i(){return this.data.DataVersion}get u(){return this.data.xPos??this.data.Level?.["xPos"]}get A(){return this.data.zPos??this.data.Level?.["zPos"]}}
function Sb(a,b,c,d){c=(b&15)+16*(d&15)+256*(c&15);b=(1<<a.i)-1;var e=c*a.i+Math.floor(c/Math.floor(64/a.i))*(2529>a.u?0:64%a.i);c=8*Math.floor(e/64);if(d=a.A){a=e%64;if(32>a)return e=d.getUint32(c+4),c=d.getUint32(c),(e>>>a|c<<31-a<<1)&b;e=d.getUint32(c);c=c+8<d.byteLength?d.getUint32(c+12):0;return(e>>>a-32|c<<63-a<<1)&b}return 0}
class Wb{constructor(a,b){this.u=a;this.j=(b.block_states?.["palette"]??b.Palette??[{Name:"minecraft:air",Properties:{}}]).map(ia);this.y=b.Y??0;this.A=b.block_states?.["data"]??b.BlockStates;this.i=Math.max(Math.ceil(Math.log2(this.j.length)),4)}};const Xb=document.getElementById("litematic");Xb.addEventListener("change",async()=>{var a=Xb.files;if(!a||1<a.length)throw Error("One file at a time");0!==a.length&&(console.log(a),a=await (0,Nb)(a[0]),a=new Gb(a),Yb(a))});const Zb=document.getElementById("region");
Zb.addEventListener("change",async()=>{var a=Zb.files;if(!a||1<a.length)throw Error("One file at a time");if(0===a.length)console.log("No files, doing nothing.");else{var b=new Kb,c=document.getElementById("block-readout");b.addEventListener("hover",e=>{c.textContent=e.detail.J});console.log(a);a=await (0,Nb)(a[0]);a=new Ub(new DataView(a.buffer));b=new Set;var d=new Map;for(let e=0;32>e;e++)for(let f=0;32>f;f++)console.log("processing",e,f),Tb(a,e,f,b,d);console.log("done.",b,d);b.has("minecraft:budding_amethyst")&&
console.log("Has budding amethyst!")}});const $b=document.getElementById("preview");
$b.addEventListener("change",async()=>{var a=$b.files;if(!a||1<a.length)throw Error("One file at a time");if(0===a.length)console.log("File unselected");else{console.log(a);a=await (0,Nb)(a[0]);a=new Gb(a);var b=new Kb,c=document.getElementById("block-readout");b.addEventListener("hover",d=>{c.textContent=d.detail.J});console.log(a,b);for(let d=0;d<a.height;d++)for(let e=0;e<a.length;e++)for(let f=0;f<a.width;f++)U(b,f,d,e,Fb(a,f,d,e))}});
document.getElementById("sample").addEventListener("click",()=>{var a=new Uint8Array([31,139,8,0,0,0,0,0,0,255,141,84,193,78,220,48,16,125,238,134,146,205,178,37,149,232,133,79,64,226,194,177,167,0,75,37,14,139,86,101,197,181,50,27,179,24,188,49,138,29,169,32,245,135,122,234,183,33,238,219,73,28,39,33,93,84,70,145,60,243,242,198,111,98,229,57,2,6,216,155,202,76,44,114,126,99,39,220,242,43,145,27,169,51,32,250,61,192,118,83,97,43,66,56,21,150,167,196,9,48,154,203,149,56,205,5,183,34,5,216,175,243,
249,159,131,0,59,37,58,213,169,188,145,45,28,97,124,150,45,148,54,50,91,94,202,39,49,0,251,73,251,125,162,245,177,94,159,104,29,35,196,104,34,204,34,151,15,182,146,28,96,244,93,44,41,61,213,69,102,137,194,8,153,107,203,213,137,210,139,123,67,200,69,136,143,199,133,189,213,57,118,243,194,24,161,148,121,200,117,97,205,145,231,94,105,85,172,4,48,124,9,17,92,112,74,163,187,194,216,195,165,208,41,229,216,118,26,38,234,226,59,24,85,26,151,150,62,176,20,154,1,1,234,112,73,76,79,130,119,4,145,152,207,99,
215,28,116,223,199,110,97,21,218,48,19,230,155,75,130,19,122,83,143,53,187,184,189,227,78,221,17,218,128,117,37,223,138,146,144,196,126,26,52,213,255,226,93,164,42,154,243,248,103,150,254,30,213,4,147,234,40,106,46,107,178,238,169,50,87,38,27,196,88,205,141,189,220,94,178,73,185,31,73,47,97,241,171,225,186,253,140,161,247,77,174,231,203,6,153,196,97,65,31,239,199,16,159,103,34,75,201,67,213,143,57,151,206,0,100,83,132,51,242,86,105,153,218,89,168,157,53,174,157,85,53,183,191,243,140,43,97,173,136,
8,255,224,45,49,94,249,43,224,43,151,57,60,188,223,194,215,69,90,138,255,32,216,222,62,26,75,186,65,223,205,235,245,250,185,113,115,59,240,55,85,200,180,29,120,88,94,19,74,156,101,150,134,22,30,11,95,213,20,127,1,31,118,161,121,155,4,0,0]);a=new Gb(a);Yb(a)});const ac=document.getElementById("afk"),bc=document.getElementById("afk-spot-log");
ac.addEventListener("change",async()=>{function a(...w){console.log(...w);w=w.map(M=>M?M.toString():"");bc.textContent+=w.join("\t")+"\n"}function b(w,M,q,v){w[M]=(w[M]??0)+q;w[M]>u&&(u=w[M],l=M,B=v)}bc.textContent="";const c=Array.from(ac.files??[]);a(`Processing ${c.length} region files...`);const d={},e={},f={},k={};let l=(0,H)(0,0,0),u=-1,B="",D=0;for(const w of c){a(`Processing ${w.name} (${Math.floor(D/c.length*100)}% overall)`);D++;try{if(0===w.size){a("  (Skipping empty region)");continue}w.name.endsWith(".mca")||
a("  (Skipping unknown file type)");const M=await (0,Nb)(w),q=Pb(new Ub(new DataView(M.buffer)));var F=0;const v=Object.keys(q);for(const r of v)F+=q[r];a(`  found ${F} budding amethyst blocks across ${v.length} chunks`);for(const r of Object.keys(q)){const [X,,R]=(0,Cb)(r);F=X+.5;const S=R+.5;for(let K=-8;8>=K;K++)for(let I=-8;8>=I;I++){const V=(0,H)(X+K,0,R+I);let N=F-(X+K+.5-.03125),O=S-(R+I+.5-.03125);64>N*N+O*O&&b(d,V,q[r],"7:0:7");N=F-(X+K+.5-.03125);O=S-(R+I+.5+.03125);64>N*N+O*O&&b(e,V,q[r],
"7:0:8");N=F-(X+K+.5+.03125);O=S-(R+I+.5+.03125);64>N*N+O*O&&b(k,V,q[r],"8:0:8");N=F-(X+K+.5+.03125);O=S-(R+I+.5-.03125);64>N*N+O*O&&b(f,V,q[r],"8:0:7")}}a(`Best so far: ${u} budding amethyst blocks, from ${B} in chunk ${l}`)}catch(M){a("Error:",M),console.log(M)}}a(`Best overall: ${u} budding amethyst blocks, from ${B} in chunk ${l}`);const [aa,,fa]=(0,Cb)(l),[G,,L]=(0,Cb)(B);a(`AFK at the coordinates X:${16*aa+G}, Z: ${16*fa+L} to have ${u} blocks in range.`);console.log(d)});
function Yb(a){function b(y,z,h,x,p,P){const J={};p=[h(p,P)];for(P=0;p.length&&P<y;){const Q=p.shift();if(!J[Q]){if(!z[Q]){const [t,Y]=x(Q);P+=1;p.push(h(t+1,Y),h(t-1,Y),h(t,Y+1),h(t,Y-1))}J[Q]=!0}}return P>=y}function c(y,z,h,x,p,P,J,Q,t){function Y(g){return g?g.type.includes("slime")||g.type.includes("regular"):!1}function ba(g){return g?g.type.includes("slime"):!1}function Da(g){function Z(A,T,ua,xa){var ja=t(A,T);if(qa[ja])return 0;qa[ja]=!0;const va=g[ja];if(!va)return 0;if(1===ua&&va.type.includes("regular"))return qa[ja]=
!1,0;ja=1;va.type.includes("slime")&&(ja+=Z(A+1,T,ua+1,xa),ja+=Z(A-1,T,ua+1,xa),ja+=Z(A,T+1,ua+1,xa),ja+=Z(A,T-1,ua+1,xa));va.j(0);return va.type.includes("slime")||va.type.includes("regular")?(1===ua&&va.j(ja),va.setColor(xa),ja):0}let ea=0;const qa={};for(var W of eb(db(new ma(p,P+1))))for(var ka of db(new ma(J,Q+1))){const A=t(W,ka);g[A].T(!1);qa[A]||!g[A]||g[A].type.includes("air")||g[A].type.includes("amethyst")||(Z(W,ka,1,ea),ea+=1);g[A].type.includes("slime")?g[A].I(Y(g[t(W+1,ka)]),Y(g[t(W-
1,ka)]),Y(g[t(W,ka-1)]),Y(g[t(W,ka+1)])):g[A].type.includes("regular")?g[A].I(ba(g[t(W+1,ka)]),ba(g[t(W-1,ka)]),ba(g[t(W,ka-1)]),ba(g[t(W,ka+1)])):g[A].I(!0,!0,!0,!0)}for(const A of eb(db(new ma(p,P+1))))for(const T of db(new ma(J,Q+1))){W=t(A,T);ka=g[W].type;ka.includes("regular")&&(g[t(A+1,T)]&&ba(g[t(A+1,T)])&&g[t(A+1,T)].color!==g[W].color||g[t(A-1,T)]&&ba(g[t(A-1,T)])&&g[t(A-1,T)].color!==g[W].color||g[t(A,T+1)]&&ba(g[t(A,T+1)])&&g[t(A,T+1)].color!==g[W].color||g[t(A,T-1)]&&ba(g[t(A,T-1)])&&
g[t(A,T-1)].color!==g[W].color)&&g[W].T(!0);const [ua,xa,ja]=(0,Cb)(W);U(d,ua,xa,ja,{slime:"minecraft:slime_block","extra-slime":"minecraft:slime_block",amethyst:"minecraft:obsidian",regular:"minecraft:smooth_basalt","optional-regular":"minecraft:smooth_basalt","optional-slime":"minecraft:slime_block","optional-air":"minecraft:air"}[ka]??"minecraft:air")}ya.textContent=String(ea);Jb(d)}const Ea={},na=y.querySelector(".grid"),ya=y.querySelector(".count");class ra{constructor(g,Z,ea,qa){this.a=g;this.b=
Z;this.type=ea;this.i=qa;this.color=0;this.type=ea;this.i=qa;this.i.classList.add("block",ea);this.i.addEventListener("click",()=>this.u());this.i.style.top=`${32*(P-g+1)}px`;this.i.style.left=`${32*(Z-J+1)}px`;this.I(!1,!1,!1,!1)}u(){this.i.classList.toggle(this.type);"air"===this.type?this.type="extra-slime":"extra-slime"===this.type?(this.type="air",this.j(0)):"slime"===this.type?this.type="regular":"regular"===this.type?this.type="slime":"optional-air"===this.type?this.type="optional-slime":"optional-slime"===
this.type?this.type="optional-regular":"optional-regular"===this.type&&(this.type="optional-air");this.i.classList.toggle(this.type);Da(Ea)}I(g,Z,ea,qa){this.i.style.borderTop=g?"none":"6px solid";this.i.style.borderBottom=Z?"none":"6px solid";this.i.style.borderLeft=ea?"none":"6px solid";this.i.style.borderRight=qa?"none":"6px solid";this.i.style.borderColor=Na[(this.color??0)%Na.length]}setColor(g){this.color=g;this.i.style.borderColor=Na[g%Na.length]}j(g){this.i.innerText=0<g?String(g):"";this.i.classList.toggle("invalid",
12<g)}T(g){this.i.classList.toggle("invalid",g)}}na.style.height=`${32*(P-p+3)}px`;na.style.width=`${32*(Q-J+3)}px`;for(const g of eb(db(new ma(p,P+1)))){for(const Z of db(new ma(J,Q+1))){y=document.createElement("div");na.appendChild(y);const ea=t(g,Z);Ea[ea]=z[ea]?new ra(g,Z,"slime",y):x[ea]?new ra(g,Z,"amethyst",y):h[ea]?new ra(g,Z,"optional-air",y):new ra(g,Z,"air",y)}na.appendChild(document.createElement("br"))}Da(Ea)}const d=new Kb,e=document.getElementById("block-readout");d.addEventListener("hover",
y=>{e.textContent=y.detail.J});const f={},k={},l={};let u=1E100,B=-1E100,D=1E100,F=-1E100,aa=1E100,fa=-1E100;for(var G=0;G<a.height;G++)for(var L=0;L<a.length;L++)for(var w=0;w<a.width;w++){var M=Fb(a,w,G,L);"minecraft:budding_amethyst"===M&&(U(d,w,G,L,M),u=Math.min(w,u),B=Math.max(w,B),D=Math.min(G,D),F=Math.max(G,F),aa=Math.min(L,aa),fa=Math.max(L,fa))}const q=B+3,v=F+3,r=fa+3;for(G=0;G<a.height;G++)for(L=0;L<a.length;L++)for(w=0;w<a.width;w++)"minecraft:budding_amethyst"===Fb(a,w,G,L)&&(f[(0,H)(q,
G,L)]=!0,k[(0,H)(w,v,L)]=!0,l[(0,H)(w,G,r)]=!0);d.camera.position.set(-5,F+5,-5);d.L.target.set((u+B)/2,(D+F)/2,(aa+fa)/2);console.log("EXTENTS:","x:",u,B,"y:",D,F,"z:",aa,fa);console.log(f,k,l);G={};L={};w={};for(var X of db(new ma(u,B+1)))for(var R of db(new ma(aa,fa+1)))!k[(0,H)(X,v,R)]&&(k[(0,H)(X-1,v,R)]||k[(0,H)(X+1,v,R)]||k[(0,H)(X,v,R-1)]||k[(0,H)(X,v,R+1)])&&(L[(0,H)(X,v,R)]=!0);for(var S of db(new ma(D,F+1)))for(var K of db(new ma(aa,fa+1)))!f[(0,H)(q,S,K)]&&(f[(0,H)(q,S-1,K)]||f[(0,H)(q,
S+1,K)]||f[(0,H)(q,S,K-1)]||f[(0,H)(q,S,K+1)])&&(G[(0,H)(q,S,K)]=!0);for(var I of db(new ma(u,B+1)))for(var V of db(new ma(D,F+1)))!l[(0,H)(I,V,r)]&&(l[(0,H)(I-1,V,r)]||l[(0,H)(I+1,V,r)]||l[(0,H)(I,V-1,r)]||l[(0,H)(I,V+1,r)])&&(w[(0,H)(I,V,r)]=!0);for(var N of Object.keys(G))if(G[N]){const [,y,z]=(0,Cb)(N);b(4,f,(h,x)=>(0,H)(q,h,x),h=>{const [,x,p]=(0,Cb)(h);return[x,p]},y,z)||(G[N]=!1,f[N]=!0)}for(var O of Object.keys(L))if(L[O]){const [y,,z]=(0,Cb)(O);b(5,k,(h,x)=>(0,H)(h,v,x),h=>{const [x,,p]=
(0,Cb)(h);return[x,p]},y,z)||(L[O]=!1,k[O]=!0)}for(var sa of Object.keys(w))if(w[sa]){const [y,z]=(0,Cb)(sa);b(4,l,(h,x)=>(0,H)(h,x,r),h=>{const [x,p]=(0,Cb)(h);return[x,p]},y,z)||(w[sa]=!1,l[sa]=!0)}R=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]];K={};X={};S={};for(I=0;I<a.height;I++)for(V=0;V<a.length;V++)for(N=0;N<a.width;N++)if("minecraft:budding_amethyst"===Fb(a,N,I,V))for(const [y,z,h]of R)if(O=N+y,sa=I+z,M=V+h,"minecraft:budding_amethyst"!==Fb(a,O,sa,M)){const x=(0,H)(O,sa,M);K[x]=!0;
G[(0,H)(q,sa,M)]||L[(0,H)(O,v,M)]||w[(0,H)(O,sa,r)]?X[x]=!0:S[x]=!0}K=Object.keys(K).length;I=Object.keys(X).length;V=Object.keys(S).length;console.log("TOTAL FACES EXPOSED: ",K);console.log("ACCESSIBLE FACES: ",I);console.log("UNREACHABLE FACES: ",V);console.log("THEORETICAL MAX EFFICIENCY: ",`${Math.round(I/K*1E4)/100}% `);console.log("EXPECTED SHARDS PER HOUR",.5170611995265756*I);K="minecraft:amethyst_cluster[facing=west,waterlogged=false] minecraft:amethyst_cluster[facing=east,waterlogged=false] minecraft:amethyst_cluster[facing=down,waterlogged=false] minecraft:amethyst_cluster[facing=up,waterlogged=false] minecraft:amethyst_cluster[facing=north,waterlogged=false] minecraft:amethyst_cluster[facing=south,waterlogged=false]".split(" ");
for(var Fa of Object.keys(S)){const [y,z,h]=(0,Cb)(Fa);for(S=0;S<R.length;S++){const [x,p,P]=R[S];if("minecraft:budding_amethyst"===Fb(a,y+x,z+p,h+P)){U(d,y,z,h,K[S]);break}}}a={};Fa={};R={};for(const y of Object.keys(X)){const [z,h,x]=(0,Cb)(y);G[(0,H)(q,h,x)]?a[(0,H)(q,h,x)]=!0:w[(0,H)(z,h,r)]?R[(0,H)(z,h,r)]=!0:L[(0,H)(z,v,x)]&&(Fa[(0,H)(z,v,x)]=!0)}const Na="#003f5c #2f4b7c #665191 #a05195 #d45087 #f95d6a #ff7c43 #ffa600".split(" ");console.log("y slime used",Fa);c(document.querySelector(".x-axis"),
a,G,f,D,F,aa,fa,(y,z)=>(0,H)(q,y,z));c(document.querySelector(".y-axis"),Fa,L,k,u,B,aa,fa,(y,z)=>(0,H)(y,v,z));c(document.querySelector(".z-axis"),R,w,l,D,F,u,B,(y,z)=>(0,H)(z,y,r));U(d,q+2,v+2,r,"minecraft:sticky_piston[extended=false,facing=up]");U(d,q+2,v+2,r-1,"minecraft:piston[extended=false,facing=up]");U(d,q+2,v+2,r-2,"minecraft:observer[facing=up]");U(d,q+2,v+2,r-3,"minecraft:redstone_lamp[facing=up]");U(d,q+2,v+2,r-4,"minecraft:redstone_lamp[lit=true]");U(d,q+2,v+2,r-5,"minecraft:note_block");
U(d,q+2,v+2,r-6,"minecraft:redstone_block");U(d,q+2,v+2,r-7,"minecraft:scaffolding");U(d,q+2,v+2,r-8,"minecraft:scaffolding[bottom=true]");U(d,q+2,v+2,r-9,"minecraft:repeater[delay=1,facing=east,locked=false,powered=true]");U(d,q+2,v+2,r-10,"minecraft:comparator[facing=north,mode=compare,powered=true]");U(d,q+2,v+2,r-11,"minecraft:comparator[facing=north,mode=subtract,powered=false]");U(d,q+2,v+2,r-12,"minecraft:hopper[enabled=true,facing=north]");U(d,q+2,v+2,r-13,"minecraft:hopper[enabled=true,facing=down]");
U(d,q+2,v+2,r-14,"minecraft:small_amethyst_bud[facing=up]");U(d,q+2,v+2,r-15,"minecraft:medium_amethyst_bud[facing=up]");U(d,q+2,v+2,r-16,"minecraft:large_amethyst_bud[facing=up]");U(d,q+2,v+2,r-17,"minecraft:amethyst_cluster[facing=down]");U(d,q+2,v+2,r-18,"minecraft:stone_bricks");U(d,q+2,v+2,r-19,"minecraft:amethyst_block");document.getElementById("save").onclick=()=>{var y=(0,Mb),z=d,h=new Hb;for(var x of Object.keys(z.i)){const [ya,ra,g]=(0,Cb)(x);var p=h.canvas,P=p.set;var J=h;var Q=z.i[x]??
"minecraft:air";void 0===J.j[Q]&&(J.i.push(Q),J.j[Q]=J.i.length-1);J=J.j[Q];P.call(p,ya,ra,g,J)}z=h.u;p=h.canvas;x=p.width;J=p.height;Q=p.length;var t=new Uint16Array(x*J*Q);if(1E100===p.v)p=[t,0];else{P=0;for(let ya=0,ra=0;ya<J;ya++)for(var Y=0;Y<Q;Y++)for(var ba=0;ba<x;ba++,ra++){const g=p.get(p.v+ba,p.B+ya,p.C+Y);0!==g&&P++;t[ra]=g}p=[t,P]}const [Da,Ea]=p;p=h.canvas.i;x=Math.max(Math.ceil(Math.log2(h.i.length)),2);P=new DataView(new ArrayBuffer(8*Math.ceil(Da.length*x/64)));Q=J=0n;Y=t=0;for(var na of Da)ba=
BigInt(na)<<BigInt(t),J|=ba,Q|=ba>>64n,t+=x,64<=t&&(t-=64,P.setBigUint64(Y,J),Y+=8,J=Q,Q=0n);na=BigInt(Date.now());h={Version:h.version,MinecraftDataVersion:2730,Metadata:{Name:h.name,Author:"russellsprouts",Description:h.description,TimeCreated:na,TimeModified:na,TotalBlocks:Ea,TotalVolume:h.canvas.width*h.canvas.height*h.canvas.length,RegionCount:1,EnclosingSize:{x:h.canvas.width,y:h.canvas.height,z:h.canvas.length}},Regions:{[h.name]:{BlockStatePalette:h.i.map(la),BlockStates:P,Position:{x:p.v,
y:p.B,z:p.C},Size:{x:h.canvas.width,y:h.canvas.height,z:h.canvas.length},Entities:[],PendingBlockTicks:[],TileEntities:[]}}};na=z.i;p=new nb;wb(h,"root");jb(p,10);lb(p,"");xb(z,p,h,na,"root");h=new DataView(p.data.buffer,0,p.i);h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength);h=ha.gzip(h);y(h,"geode-farm-export.litematic")}};
//# sourceMappingURL=main.js.map
