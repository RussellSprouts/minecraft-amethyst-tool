'use strict';function db(a){return new na(a.start-1,a.end+1,a.i)}function eb(a){return new na(a.end-1,a.start-1,-a.i)}function fb(a,b){return"*"===a?"*":Array.isArray(a)?a[0]:a["*"]?a["*"]:a[b]??"*"}function gb(a,b,c){if(!a)throw Error(`${b}\n${c}`);}function hb(a){throw Error(`Unexpected case: ${a}`);}
function ib(a,b){if(a.i+b>a.data.byteLength){for(var c=2*a.data.byteLength;a.i+b>c;)c*=2;b=new DataView(new ArrayBuffer(c));for(c=0;c<a.data.byteLength;c++)b.setInt8(c,a.data.getInt8(c));a.data=b}}function jb(a,b){ib(a,1);a.data.setInt8(a.i,b);a.i++}function kb(a,b){ib(a,4);a.data.setInt32(a.i,b);a.i+=4}function lb(a,b){b=ea.encode(b);ib(a,b.byteLength+2);a.data.setUint16(a.i,b.byteLength);a.i+=2;for(let c=0;c<b.byteLength;c++)a.data.setUint8(a.i+c,b[c]);a.i+=b.byteLength}
function mb(a,b,c){c=Math.floor(b.byteLength/c);ib(a,b.byteLength+4);a.data.setInt32(a.i,c);a.i+=4;for(c=0;c<b.byteLength;c++)a.data.setUint8(a.i+c,b.getUint8(c));a.i+=b.byteLength}class nb{constructor(){this.i=0;this.data=new DataView(new ArrayBuffer(1024))}}function ob(a){a.i+=1;return a.data.getInt8(a.i-1)}function pb(a){a.i+=4;return a.data.getInt32(a.i-4)}function qb(a){const b=a.data.getUint16(a.i);a.i+=2;const c=0===b?"":da.decode(new DataView(a.data.buffer,a.i,b));a.i+=b;return c}
function rb(a,b){const c=pb(a);b=new DataView(a.data.buffer,a.i,c*b);a.i+=b.byteLength;return b}class sb{constructor(a){this.data=a;this.i=0}}
function tb(a,b,c,d,e){switch(c){case 0:break;case 1:return ub(d,"byte",e),ob(b);case 2:return ub(d,"short",e),b.i+=2,b.data.getInt16(b.i-2);case 3:return ub(d,"int",e),pb(b);case 4:return ub(d,"long",e),b.i+=8,b.data.getBigInt64(b.i-8);case 5:return ub(d,"float",e),b.i+=4,b.data.getFloat32(b.i-4);case 6:return ub(d,"double",e),b.i+=8,b.data.getFloat64(b.i-8);case 8:return ub(d,"string",e),qb(b);case 7:return ub(d,"byteArray",e),rb(b,1);case 11:return ub(d,"intArray",e),rb(b,4);case 12:return ub(d,
"longArray",e),rb(b,8);case 10:vb(d,e);c={};for(var f;0!==(f=ob(b));){var k=qb(b);f=tb(a,b,f,fb(d,k),`${e}.${k}`);if("*"===d||d["*"]||k in d)c[k]=f}return c;case 9:gb("*"===d||Array.isArray(d),`Found a list, but expected ${d}`,e);c=ob(b);k=pb(b);f=[];for(let l=0;l<k;l++)f.push(tb(a,b,c,fb(d,0),`${e}[${l}]`));return f;default:hb(c)}}function ub(a,b,c){gb("*"===a||a===b,`Found a ${b}, but expected ${a}`,c)}
function vb(a,b){gb("*"===a||!Array.isArray(a)&&"object"===typeof a,`Found a compound, but expected ${a}.`,b)}function wb(a,b){gb("object"===typeof a,`Expected an object, got ${a}`,b);return a}
function xb(a,b,c,d,e){switch(d){case "byte":jb(b,yb(c,e));break;case "short":a=yb(c,e);ib(b,2);b.data.setInt16(b.i,a);b.i+=2;break;case "int":kb(b,yb(c,e));break;case "long":gb("bigint"===typeof c,`Expected a bigint, got ${c}`,e);ib(b,8);b.data.setBigInt64(b.i,c);b.i+=8;break;case "float":a=yb(c,e);ib(b,4);b.data.setFloat32(b.i,a);b.i+=4;break;case "double":a=yb(c,e);ib(b,8);b.data.setFloat64(b.i,a);b.i+=8;break;case "byteArray":mb(b,zb(c,e),1);break;case "intArray":mb(b,zb(c,e),4);break;case "longArray":mb(b,
zb(c,e),8);break;case "string":gb("string"===typeof c,`Expected a string, got ${c}`,e);lb(b,c);break;case "end":break;case "*":gb(!1,`Can't write value of unknown type: ${c}`,e);break;default:if(Array.isArray(d)){[d]=d;gb(Array.isArray(c),`Expected an array, got ${c}`,e);jb(b,Ab(d));kb(b,c.length);var f=0;for(var k of c)xb(a,b,k,d,`${e}[${f++}]`)}else if("object"===typeof d){vb(d,e);c=wb(c,e);k=Object.keys(c).sort();for(f of k)k=fb(d,f),jb(b,Ab(k)),lb(b,f),xb(a,b,c[f],k,`${e}.${f}`);jb(b,0)}else hb(d)}}
function yb(a,b){gb("number"===typeof a,`Expected a number, got ${a}`,b);return a}function zb(a,b){gb(a instanceof DataView,`Expected a DataView, got ${a}`,b);return a}
function Ab(a){switch(a){case "byte":return 1;case "short":return 2;case "int":return 3;case "long":return 4;case "float":return 5;case "double":return 6;case "byteArray":return 7;case "intArray":return 11;case "longArray":return 12;case "string":return 8;case "end":return 0;case "*":return 0;default:if(Array.isArray(a))return 9;if("object"===typeof a)return 10;hb(a)}}
var Bb=class{constructor(a){this.i=a}parse(a){a=new DataView(a.buffer,a.byteOffset,a.byteLength);a=new sb(a);gb(10===ob(a),"Expected a compound at root");gb(""===qb(a),"Expected an empty name at root");return tb(this,a,10,this.i,"root")}};function F(a,b,c){return`${a}:${b}:${c}`}function Cb(a){return a.split(":").map(b=>+b)}
var Db=class{constructor(){this.segments={};this.v=1E100;this.D=-1E100;this.B=1E100;this.F=-1E100;this.C=1E100;this.G=-1E100}get i(){return 1E100===this.v?{v:0,D:0,B:0,F:0,C:0,G:0}:{v:this.v,D:this.D,B:this.B,F:this.F,C:this.C,G:this.G}}get width(){return 1E100===this.v?1:this.D-this.v+1}get height(){return 1E100===this.B?1:this.F-this.B+1}get length(){return 1E100===this.C?1:this.G-this.C+1}get(a,b,c){var d=Math.floor(a/16);const e=Math.floor(b/16),f=Math.floor(c/16);a=(a%16+16)%16;b=(b%16+16)%16;
c=(c%16+16)%16;d=(0,F)(d,e,f);return this.segments[d]?this.segments[d][a+16*(c+16*b)]:0}set(a,b,c,d){this.D=Math.max(this.D,a);this.F=Math.max(this.F,b);this.G=Math.max(this.G,c);this.v=Math.min(this.v,a);this.B=Math.min(this.B,b);this.C=Math.min(this.C,c);var e=Math.floor(a/16);const f=Math.floor(b/16),k=Math.floor(c/16);a=(a%16+16)%16;b=(b%16+16)%16;c=(c%16+16)%16;e=(0,F)(e,f,k);this.segments[e]||(this.segments[e]=new Uint16Array(4096));this.segments[e][a+16*(c+16*b)]=d}},Eb={Version:"int",MinecraftDataVersion:"int",
Metadata:{Name:"string",Author:"string",Description:"string",EnclosingSize:{x:"int",y:"int",z:"int"},TimeCreated:"long",TimeModified:"long",TotalBlocks:"int",TotalVolume:"int",RegionCount:"int"},Regions:{"*":{BlockStatePalette:[{Name:"string",Properties:{"*":"string"}}],BlockStates:"longArray",Position:{x:"int",y:"int",z:"int"},Size:{x:"int",y:"int",z:"int"},Entities:[{"*":"*"}],TileEntities:[{"*":"*"}],PendingBlockTicks:[{"*":"*"}]}}};
function Fb(a,b,c,d){return 0>b||b>=a.width||0>c||c>=a.height||0>d||d>=a.length?"minecraft:air":a.j[a.u[b+a.width*(d+a.length*c)]]}
var Gb=class{constructor(a){this.A=new Bb(Eb);a=ia.ungzip(new Uint8Array(a));this.i=this.A.parse(a);a=Object.keys(this.i.Regions);1!==a.length&&console.warn("SchematicReader only supports a single region for now.");this.H=a[0];a=this.i.Regions[this.H];this.j=a.BlockStatePalette.map(ja);const b=BigInt(Math.max(Math.ceil(Math.log2(this.j.length)),2)),c=(1n<<b)-1n,d=this.width=Math.abs(a.Size.x),e=this.height=Math.abs(a.Size.y),f=this.length=Math.abs(a.Size.z);this.u=new Uint16Array(d*e*f);let k=0n;
for(let v=0;v<e;v++)for(let z=0;z<f;z++)for(let C=0;C<d;C++){var l=Number(k/64n*8n);const T=a.BlockStates.getBigUint64(l);l=((l+8<a.BlockStates.byteLength?a.BlockStates.getBigUint64(l+8):0n)<<64n)+T;this.u[C+d*(z+f*v)]=Number(l>>k%64n&c);k+=b}}get version(){return this.i.Version}get name(){return this.i.Metadata.Name}get description(){return this.i.Metadata.Description}},Hb=class{constructor(){this.name="schematic";this.u=new Bb(Eb);this.description="";this.j={"minecraft:air":0};this.i=["minecraft:air"];
this.canvas=new Db;this.version=5}};function Ib(a,b){if(a[b])return a[b];const c=b.indexOf("[");return-1!==c?a[b.slice(0,c)]??a["default"]:a["default"]}function Jb(a){a.K||(a.K=!0,requestAnimationFrame(()=>a.render()))}function X(a,b,c,d,e){const f=(0,F)(b,c,d);if(a.i[f]!==e&&(a.i[f]=e,a.u[f]&&a.j.remove(a.u[f]),a.u[f]=void 0,"minecraft:air"!==e&&"minecraft:cave_air"!==e)){const k=new m.Mesh(Ib(Ra,e),Ib(Qa,e));k.position.set(b,c,d);k.setRotationFromEuler(Ib(cb,e));a.u[f]=k;a.j.add(k)}}
var Kb=class extends EventTarget{constructor(){super();this.i={};this.u={};this.K=!1;const a=document.querySelector("#c");this.A=new m.WebGLRenderer({canvas:a});this.H=new m.Vector2;a.addEventListener("mousemove",c=>{const d=a.getBoundingClientRect();this.H.x=(c.clientX-d.left)/a.clientWidth*2-1;this.H.y=2*-((c.clientY-d.top)/a.clientHeight)+1;Jb(this)});this.S=new m.Raycaster;var b=new m.Scene;b.background=new m.Color("lightblue");this.R=new m.DirectionalLight(7829367);this.R.position.set(0,1,0);
b.add(this.R);this.O=new m.DirectionalLight(4473924);this.O.position.set(1,0,0);b.add(this.O);this.M=new m.DirectionalLight(4473924);this.M.position.set(-1,0,0);b.add(this.M);this.P=new m.DirectionalLight(2236962);this.P.position.set(0,0,1);b.add(this.P);this.N=new m.DirectionalLight(2236962);this.N.position.set(0,0,-1);b.add(this.N);this.U=new m.AmbientLight(8947848);b.add(this.U);this.j=b;this.camera=new m.PerspectiveCamera(75,2,.1,1E3);b=new pa.OrbitControls(this.camera,a);b.update();b.minDistance=
1;b.maxDistance=100;this.L=b;b.addEventListener("change",()=>Jb(this));window.addEventListener("resize",()=>Jb(this));this.render()}render(){this.K=!1;var a=this.A.domElement,b=a.clientWidth,c=a.clientHeight;(a=a.width!==b||a.height!==c)&&this.A.setSize(b,c,!1);a&&(b=this.A.domElement,this.camera.aspect=b.clientWidth/b.clientHeight,this.camera.updateProjectionMatrix());this.S.setFromCamera(this.H,this.camera);for(var d of this.j.children)d.visible=!0;d=this.S.intersectObjects(this.j.children);for(var e of d){d=
e.object.position.x|0;b=e.object.position.y|0;a=e.object.position.z|0;e=this.dispatchEvent;c=CustomEvent;var f=d;var k=b,l=a;f=this.i[(0,F)(f,k,l)]??"minecraft:air";e.call(this,new c("hover",{detail:{x:d,y:b,z:a,J:f}}));break}this.L.update();this.A.render(this.j,this.camera)}};function Lb(a,b){const c=document.createElement("a");c.href=a;c.download=b;c.style.display="none";document.body.appendChild(c);c.click();c.remove()}
function Mb(a,b,c="application/octet-stream"){const d=window.URL.createObjectURL(new Blob([a],{type:c}));Lb(d,b);setTimeout(()=>window.URL.revokeObjectURL(d),1E3)}function Nb(a){return new Promise((b,c)=>{const d=new FileReader;d.addEventListener("load",()=>{b(new Uint8Array(d.result))});d.addEventListener("error",()=>{c(d.error)});d.addEventListener("abort",()=>{c(Error("load aborted"))});d.readAsArrayBuffer(a)})};const Ob=4096/3/.2*6;console.log(Ob,"EXPECTED");console.log("EXPECTED OUTPUT PER HOUR",35.2*Ob/72E3);function Pb(a,b,c){b=4*((b&31)+32*(c&31));return 0>=a.i.getUint8(b+3)?-1:4096*(a.i.getUint32(b)>>8)}
function Qb(a){const b={};for(let e=0;32>e;e++)for(let f=0;32>f;f++){var c=Pb(a,e,f);if(!(0>c)){var d=a.i.getUint32(c);a.i.getUint8(c+4);c=new Uint8Array(a.i.buffer,c+5,d-1);c=ia.ungzip(c);c=(new Bb(Rb)).parse(c);c=new Sb(c);d=0;for(const k of c.j){const l=k.j.indexOf("minecraft:budding_amethyst");if(-1!==l)for(let v=0;16>v;v++)for(let z=0;16>z;z++)for(let C=0;16>C;C++)Tb(k,C,v,z)===l&&d++}0<d&&(b[(0,F)(c.u,0,c.A)]=d)}}return b}
function Ub(a,b,c,d,e){if(!a.j[`${b}:${c}`]&&(b=Pb(a,b,c),-1!==b)){c=a.i.getUint32(b);a.i.getUint8(b+4);a=new Uint8Array(a.i.buffer,b+5,c-1);performance.mark("a");a=ia.ungzip(a);b=new Bb(Rb);performance.mark("b");performance.measure("unzip","a","b");a=b.parse(a);a=new Sb(a);performance.mark("c");performance.measure("nbt-parse","b","c");for(const k of a.j){a=k.j;for(const l of a)d.add(l);for(b=0;16>b;b++)for(c=0;16>c;c++)for(let l=0;16>l;l++){var f=Tb(k,l,b,c);f=a[f];e.set(f,(e.get(f)??0)+1)}}performance.mark("d");
performance.measure("decode","c","d")}}var Vb=class{constructor(a){this.i=a;this.j={}}};const Wb={Y:"byte",block_states:{data:"longArray",palette:[{Name:"string",Properties:{"*":"string"}}]},BlockStates:"longArray",Palette:[{Name:"string",Properties:{"*":"string"}}]},Rb={DataVersion:"int",sections:[Wb],xPos:"int",zPos:"int",Level:{xPos:"int",zPos:"int",Status:"string",Sections:[Wb]}};
class Sb{constructor(a){this.data=a;this.j=this.data?.["sections"]?.map(b=>new Xb(this.i,b))??this.data?.["Level"]?.["Sections"]?.map(b=>new Xb(this.i,b))??[]}get i(){return this.data.DataVersion}get u(){return this.data.xPos??this.data.Level?.["xPos"]}get A(){return this.data.zPos??this.data.Level?.["zPos"]}}
function Tb(a,b,c,d){c=(b&15)+16*(d&15)+256*(c&15);b=(1<<a.i)-1;var e=c*a.i+Math.floor(c/Math.floor(64/a.i))*(2529>a.u?0:64%a.i);c=8*Math.floor(e/64);if(d=a.A){a=e%64;if(32>a)return e=d.getUint32(c+4),c=d.getUint32(c),(e>>>a|c<<31-a<<1)&b;e=d.getUint32(c);c=c+8<d.byteLength?d.getUint32(c+12):0;return(e>>>a-32|c<<63-a<<1)&b}return 0}
class Xb{constructor(a,b){this.u=a;this.j=(b.block_states?.["palette"]??b.Palette??[{Name:"minecraft:air",Properties:{}}]).map(ja);this.y=b.Y??0;this.A=b.block_states?.["data"]??b.BlockStates;this.i=Math.max(Math.ceil(Math.log2(this.j.length)),4)}};const Yb=document.getElementById("litematic");Yb.addEventListener("change",async()=>{var a=Yb.files;if(!a||1<a.length)throw Error("One file at a time");0!==a.length&&(console.log(a),a=await (0,Nb)(a[0]),a=new Gb(a),Zb(a))});const $b=document.getElementById("region");
$b.addEventListener("change",async()=>{var a=$b.files;if(!a||1<a.length)throw Error("One file at a time");if(0===a.length)console.log("No files, doing nothing.");else{var b=new Kb,c=document.getElementById("block-readout");b.addEventListener("hover",e=>{c.textContent=e.detail.J});console.log(a);a=await (0,Nb)(a[0]);a=new Vb(new DataView(a.buffer));b=new Set;var d=new Map;for(let e=0;32>e;e++)for(let f=0;32>f;f++)console.log("processing",e,f),Ub(a,e,f,b,d);console.log("done.",b,d);b.has("minecraft:budding_amethyst")&&
console.log("Has budding amethyst!")}});const ac=document.getElementById("preview");
ac.addEventListener("change",async()=>{var a=ac.files;if(!a||1<a.length)throw Error("One file at a time");if(0===a.length)console.log("File unselected");else{console.log(a);a=await (0,Nb)(a[0]);a=new Gb(a);var b=new Kb,c=document.getElementById("block-readout");b.addEventListener("hover",d=>{c.textContent=d.detail.J});console.log(a,b);for(let d=0;d<a.height;d++)for(let e=0;e<a.length;e++)for(let f=0;f<a.width;f++)X(b,f,d,e,Fb(a,f,d,e))}});
document.getElementById("sample").addEventListener("click",()=>{var a=new Uint8Array([31,139,8,0,0,0,0,0,0,255,141,84,193,78,220,48,16,125,238,134,146,205,178,37,149,232,133,79,64,226,194,177,167,0,75,37,14,139,86,101,197,181,50,27,179,24,188,49,138,29,169,32,245,135,122,234,183,33,238,219,73,28,39,33,93,84,70,145,60,243,242,198,111,98,229,57,2,6,216,155,202,76,44,114,126,99,39,220,242,43,145,27,169,51,32,250,61,192,118,83,97,43,66,56,21,150,167,196,9,48,154,203,149,56,205,5,183,34,5,216,175,243,
249,159,131,0,59,37,58,213,169,188,145,45,28,97,124,150,45,148,54,50,91,94,202,39,49,0,251,73,251,125,162,245,177,94,159,104,29,35,196,104,34,204,34,151,15,182,146,28,96,244,93,44,41,61,213,69,102,137,194,8,153,107,203,213,137,210,139,123,67,200,69,136,143,199,133,189,213,57,118,243,194,24,161,148,121,200,117,97,205,145,231,94,105,85,172,4,48,124,9,17,92,112,74,163,187,194,216,195,165,208,41,229,216,118,26,38,234,226,59,24,85,26,151,150,62,176,20,154,1,1,234,112,73,76,79,130,119,4,145,152,207,99,
215,28,116,223,199,110,97,21,218,48,19,230,155,75,130,19,122,83,143,53,187,184,189,227,78,221,17,218,128,117,37,223,138,146,144,196,126,26,52,213,255,226,93,164,42,154,243,248,103,150,254,30,213,4,147,234,40,106,46,107,178,238,169,50,87,38,27,196,88,205,141,189,220,94,178,73,185,31,73,47,97,241,171,225,186,253,140,161,247,77,174,231,203,6,153,196,97,65,31,239,199,16,159,103,34,75,201,67,213,143,57,151,206,0,100,83,132,51,242,86,105,153,218,89,168,157,53,174,157,85,53,183,191,243,140,43,97,173,136,
8,255,224,45,49,94,249,43,224,43,151,57,60,188,223,194,215,69,90,138,255,32,216,222,62,26,75,186,65,223,205,235,245,250,185,113,115,59,240,55,85,200,180,29,120,88,94,19,74,156,101,150,134,22,30,11,95,213,20,127,1,31,118,161,121,155,4,0,0]);a=new Gb(a);Zb(a)});const bc=document.getElementById("afk"),cc=document.getElementById("afk-spot-log");
bc.addEventListener("change",async()=>{function a(...K){console.log(...K);K=K.map(n=>n?n.toString():"");cc.textContent+=K.join("\t")+"\n"}function b(K,n,q,u){K[n]=(K[n]??0)+q;K[n]>z&&(z=K[n],v=n,C=u)}cc.textContent="";const c=Array.from(bc.files??[]);a(`Processing ${c.length} region files...`);const d={},e={},f={},k={},l={};let v=(0,F)(0,0,0),z=-1,C="",T=0;for(const K of c){a(`Processing ${K.name} (${Math.floor(T/c.length*100)}% overall)`);T++;try{if(0===K.size){a("  (Skipping empty region)");continue}K.name.endsWith(".mca")||
a("  (Skipping unknown file type)");const n=await (0,Nb)(K),q=Qb(new Vb(new DataView(n.buffer)));var P=0;const u=Object.keys(q);for(const U of u)P+=q[U];a(`  found ${P} budding amethyst blocks across ${u.length} chunks`);for(const U of Object.keys(q)){const [S,,L]=(0,Cb)(U);P=S+.5;const V=L+.5;for(let G=-8;8>=G;G++)for(let M=-8;8>=M;M++){const ba=(0,F)(S+G,0,L+M);let H=G,I=M;64>H*H+I*I&&b(l,ba,q[U],"0:0:0");H=P-(S+G+.5-.03125);I=V-(L+M+.5-.03125);64>H*H+I*I&&b(d,ba,q[U],"7:0:7");H=P-(S+G+.5-.03125);
I=V-(L+M+.5+.03125);64>H*H+I*I&&b(e,ba,q[U],"7:0:8");H=P-(S+G+.5+.03125);I=V-(L+M+.5+.03125);64>H*H+I*I&&b(k,ba,q[U],"8:0:8");H=P-(S+G+.5+.03125);I=V-(L+M+.5-.03125);64>H*H+I*I&&b(f,ba,q[U],"8:0:7")}}a(`Best so far: ${z} budding amethyst blocks, from ${C} in chunk ${v}`)}catch(n){a("Error:",n),console.log(n)}}a(`Best overall: ${z} budding amethyst blocks, from ${C} in chunk ${v}`);const [ha,,E]=(0,Cb)(v),[N,,O]=(0,Cb)(C);a(`AFK at the coordinates X:${16*ha+N}, Z: ${16*E+O} to have ${z} blocks in range.`);
console.log(d)});const dc=document.getElementById("nbt");dc.addEventListener("change",async()=>{var a=dc.files??[];let b=a=await (0,Nb)(a[0]);try{b=ia.ungzip(a)}catch(c){}console.log((new Bb("*")).parse(b))});
function Zb(a){function b(x,y,h,w,r,Q){const J={};r=[h(r,Q)];for(Q=0;r.length&&Q<x;){const R=r.shift();if(!J[R]){if(!y[R]){const [t,Z]=w(R);Q+=1;r.push(h(t+1,Z),h(t-1,Z),h(t,Z+1),h(t,Z-1))}J[R]=!0}}return Q>=x}function c(x,y,h,w,r,Q,J,R,t){function Z(g){return g?g.type.includes("slime")||g.type.includes("regular"):!1}function ca(g){return g?g.type.includes("slime"):!1}function Ga(g){function aa(A,W,ua,xa){var ka=t(A,W);if(ra[ka])return 0;ra[ka]=!0;const va=g[ka];if(!va)return 0;if(1===ua&&va.type.includes("regular"))return ra[ka]=
!1,0;ka=1;va.type.includes("slime")&&(ka+=aa(A+1,W,ua+1,xa),ka+=aa(A-1,W,ua+1,xa),ka+=aa(A,W+1,ua+1,xa),ka+=aa(A,W-1,ua+1,xa));va.j(0);return va.type.includes("slime")||va.type.includes("regular")?(1===ua&&va.j(ka),va.setColor(xa),ka):0}let fa=0;const ra={};for(var Y of eb(db(new na(r,Q+1))))for(var la of db(new na(J,R+1))){const A=t(Y,la);g[A].T(!1);ra[A]||!g[A]||g[A].type.includes("air")||g[A].type.includes("amethyst")||(aa(Y,la,1,fa),fa+=1);g[A].type.includes("slime")?g[A].I(Z(g[t(Y+1,la)]),Z(g[t(Y-
1,la)]),Z(g[t(Y,la-1)]),Z(g[t(Y,la+1)])):g[A].type.includes("regular")?g[A].I(ca(g[t(Y+1,la)]),ca(g[t(Y-1,la)]),ca(g[t(Y,la-1)]),ca(g[t(Y,la+1)])):g[A].I(!0,!0,!0,!0)}for(const A of eb(db(new na(r,Q+1))))for(const W of db(new na(J,R+1))){Y=t(A,W);la=g[Y].type;la.includes("regular")&&(g[t(A+1,W)]&&ca(g[t(A+1,W)])&&g[t(A+1,W)].color!==g[Y].color||g[t(A-1,W)]&&ca(g[t(A-1,W)])&&g[t(A-1,W)].color!==g[Y].color||g[t(A,W+1)]&&ca(g[t(A,W+1)])&&g[t(A,W+1)].color!==g[Y].color||g[t(A,W-1)]&&ca(g[t(A,W-1)])&&
g[t(A,W-1)].color!==g[Y].color)&&g[Y].T(!0);const [ua,xa,ka]=(0,Cb)(Y);X(d,ua,xa,ka,{slime:"minecraft:slime_block","extra-slime":"minecraft:slime_block",amethyst:"minecraft:obsidian",regular:"minecraft:smooth_basalt","optional-regular":"minecraft:smooth_basalt","optional-slime":"minecraft:slime_block","optional-air":"minecraft:air"}[la]??"minecraft:air")}ya.textContent=String(fa);Jb(d)}const Ha={},oa=x.querySelector(".grid"),ya=x.querySelector(".count");class sa{constructor(g,aa,fa,ra){this.a=g;this.b=
aa;this.type=fa;this.i=ra;this.color=0;this.type=fa;this.i=ra;this.i.classList.add("block",fa);this.i.addEventListener("click",()=>this.u());this.i.style.top=`${32*(Q-g+1)}px`;this.i.style.left=`${32*(aa-J+1)}px`;this.I(!1,!1,!1,!1)}u(){this.i.classList.toggle(this.type);"air"===this.type?this.type="extra-slime":"extra-slime"===this.type?(this.type="air",this.j(0)):"slime"===this.type?this.type="regular":"regular"===this.type?this.type="slime":"optional-air"===this.type?this.type="optional-slime":
"optional-slime"===this.type?this.type="optional-regular":"optional-regular"===this.type&&(this.type="optional-air");this.i.classList.toggle(this.type);Ga(Ha)}I(g,aa,fa,ra){this.i.style.borderTop=g?"none":"6px solid";this.i.style.borderBottom=aa?"none":"6px solid";this.i.style.borderLeft=fa?"none":"6px solid";this.i.style.borderRight=ra?"none":"6px solid";this.i.style.borderColor=Na[(this.color??0)%Na.length]}setColor(g){this.color=g;this.i.style.borderColor=Na[g%Na.length]}j(g){this.i.innerText=
0<g?String(g):"";this.i.classList.toggle("invalid",12<g)}T(g){this.i.classList.toggle("invalid",g)}}oa.style.height=`${32*(Q-r+3)}px`;oa.style.width=`${32*(R-J+3)}px`;for(const g of eb(db(new na(r,Q+1)))){for(const aa of db(new na(J,R+1))){x=document.createElement("div");oa.appendChild(x);const fa=t(g,aa);Ha[fa]=y[fa]?new sa(g,aa,"slime",x):w[fa]?new sa(g,aa,"amethyst",x):h[fa]?new sa(g,aa,"optional-air",x):new sa(g,aa,"air",x)}oa.appendChild(document.createElement("br"))}Ga(Ha)}const d=new Kb,e=
document.getElementById("block-readout");d.addEventListener("hover",x=>{e.textContent=x.detail.J});const f={},k={},l={};let v=1E100,z=-1E100,C=1E100,T=-1E100,P=1E100,ha=-1E100;for(var E=0;E<a.height;E++)for(var N=0;N<a.length;N++)for(var O=0;O<a.width;O++){var K=Fb(a,O,E,N);"minecraft:budding_amethyst"===K&&(X(d,O,E,N,K),v=Math.min(O,v),z=Math.max(O,z),C=Math.min(E,C),T=Math.max(E,T),P=Math.min(N,P),ha=Math.max(N,ha))}const n=z+3,q=T+3,u=ha+3;for(E=0;E<a.height;E++)for(N=0;N<a.length;N++)for(O=0;O<
a.width;O++)"minecraft:budding_amethyst"===Fb(a,O,E,N)&&(f[(0,F)(n,E,N)]=!0,k[(0,F)(O,q,N)]=!0,l[(0,F)(O,E,u)]=!0);d.camera.position.set(-5,T+5,-5);d.L.target.set((v+z)/2,(C+T)/2,(P+ha)/2);console.log("EXTENTS:","x:",v,z,"y:",C,T,"z:",P,ha);console.log(f,k,l);E={};N={};O={};for(var U of db(new na(v,z+1)))for(var S of db(new na(P,ha+1)))!k[(0,F)(U,q,S)]&&(k[(0,F)(U-1,q,S)]||k[(0,F)(U+1,q,S)]||k[(0,F)(U,q,S-1)]||k[(0,F)(U,q,S+1)])&&(N[(0,F)(U,q,S)]=!0);for(var L of db(new na(C,T+1)))for(var V of db(new na(P,
ha+1)))!f[(0,F)(n,L,V)]&&(f[(0,F)(n,L-1,V)]||f[(0,F)(n,L+1,V)]||f[(0,F)(n,L,V-1)]||f[(0,F)(n,L,V+1)])&&(E[(0,F)(n,L,V)]=!0);for(var G of db(new na(v,z+1)))for(var M of db(new na(C,T+1)))!l[(0,F)(G,M,u)]&&(l[(0,F)(G-1,M,u)]||l[(0,F)(G+1,M,u)]||l[(0,F)(G,M-1,u)]||l[(0,F)(G,M+1,u)])&&(O[(0,F)(G,M,u)]=!0);for(var ba of Object.keys(E))if(E[ba]){const [,x,y]=(0,Cb)(ba);b(4,f,(h,w)=>(0,F)(n,h,w),h=>{const [,w,r]=(0,Cb)(h);return[w,r]},x,y)||(E[ba]=!1,f[ba]=!0)}for(var H of Object.keys(N))if(N[H]){const [x,
,y]=(0,Cb)(H);b(5,k,(h,w)=>(0,F)(h,q,w),h=>{const [w,,r]=(0,Cb)(h);return[w,r]},x,y)||(N[H]=!1,k[H]=!0)}for(var I of Object.keys(O))if(O[I]){const [x,y]=(0,Cb)(I);b(4,l,(h,w)=>(0,F)(h,w,u),h=>{const [w,r]=(0,Cb)(h);return[w,r]},x,y)||(O[I]=!1,l[I]=!0)}S=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]];V={};U={};L={};for(G=0;G<a.height;G++)for(M=0;M<a.length;M++)for(ba=0;ba<a.width;ba++)if("minecraft:budding_amethyst"===Fb(a,ba,G,M))for(const [x,y,h]of S)if(H=ba+x,I=G+y,K=M+h,"minecraft:budding_amethyst"!==
Fb(a,H,I,K)){const w=(0,F)(H,I,K);V[w]=!0;E[(0,F)(n,I,K)]||N[(0,F)(H,q,K)]||O[(0,F)(H,I,u)]?U[w]=!0:L[w]=!0}V=Object.keys(V).length;G=Object.keys(U).length;M=Object.keys(L).length;console.log("TOTAL FACES EXPOSED: ",V);console.log("ACCESSIBLE FACES: ",G);console.log("UNREACHABLE FACES: ",M);console.log("THEORETICAL MAX EFFICIENCY: ",`${Math.round(G/V*1E4)/100}% `);console.log("EXPECTED SHARDS PER HOUR",.5170611995265756*G);V="minecraft:amethyst_cluster[facing=west,waterlogged=false] minecraft:amethyst_cluster[facing=east,waterlogged=false] minecraft:amethyst_cluster[facing=down,waterlogged=false] minecraft:amethyst_cluster[facing=up,waterlogged=false] minecraft:amethyst_cluster[facing=north,waterlogged=false] minecraft:amethyst_cluster[facing=south,waterlogged=false]".split(" ");
for(var Ia of Object.keys(L)){const [x,y,h]=(0,Cb)(Ia);for(L=0;L<S.length;L++){const [w,r,Q]=S[L];if("minecraft:budding_amethyst"===Fb(a,x+w,y+r,h+Q)){X(d,x,y,h,V[L]);break}}}a={};Ia={};S={};for(const x of Object.keys(U)){const [y,h,w]=(0,Cb)(x);E[(0,F)(n,h,w)]?a[(0,F)(n,h,w)]=!0:O[(0,F)(y,h,u)]?S[(0,F)(y,h,u)]=!0:N[(0,F)(y,q,w)]&&(Ia[(0,F)(y,q,w)]=!0)}const Na="#003f5c #2f4b7c #665191 #a05195 #d45087 #f95d6a #ff7c43 #ffa600".split(" ");console.log("y slime used",Ia);c(document.querySelector(".x-axis"),
a,E,f,C,T,P,ha,(x,y)=>(0,F)(n,x,y));c(document.querySelector(".y-axis"),Ia,N,k,v,z,P,ha,(x,y)=>(0,F)(x,q,y));c(document.querySelector(".z-axis"),S,O,l,C,T,v,z,(x,y)=>(0,F)(y,x,u));X(d,n+2,q+2,u,"minecraft:sticky_piston[extended=false,facing=up]");X(d,n+2,q+2,u-1,"minecraft:piston[extended=false,facing=up]");X(d,n+2,q+2,u-2,"minecraft:observer[facing=up]");X(d,n+2,q+2,u-3,"minecraft:redstone_lamp[facing=up]");X(d,n+2,q+2,u-4,"minecraft:redstone_lamp[lit=true]");X(d,n+2,q+2,u-5,"minecraft:note_block");
X(d,n+2,q+2,u-6,"minecraft:redstone_block");X(d,n+2,q+2,u-7,"minecraft:scaffolding");X(d,n+2,q+2,u-8,"minecraft:scaffolding[bottom=true]");X(d,n+2,q+2,u-9,"minecraft:repeater[delay=1,facing=east,locked=false,powered=true]");X(d,n+2,q+2,u-10,"minecraft:comparator[facing=north,mode=compare,powered=true]");X(d,n+2,q+2,u-11,"minecraft:comparator[facing=north,mode=subtract,powered=false]");X(d,n+2,q+2,u-12,"minecraft:hopper[enabled=true,facing=north]");X(d,n+2,q+2,u-13,"minecraft:hopper[enabled=true,facing=down]");
X(d,n+2,q+2,u-14,"minecraft:small_amethyst_bud[facing=up]");X(d,n+2,q+2,u-15,"minecraft:medium_amethyst_bud[facing=up]");X(d,n+2,q+2,u-16,"minecraft:large_amethyst_bud[facing=up]");X(d,n+2,q+2,u-17,"minecraft:amethyst_cluster[facing=down]");X(d,n+2,q+2,u-18,"minecraft:stone_bricks");X(d,n+2,q+2,u-19,"minecraft:amethyst_block");document.getElementById("save").onclick=()=>{var x=(0,Mb),y=d,h=new Hb;for(var w of Object.keys(y.i)){const [ya,sa,g]=(0,Cb)(w);var r=h.canvas,Q=r.set;var J=h;var R=y.i[w]??
"minecraft:air";void 0===J.j[R]&&(J.i.push(R),J.j[R]=J.i.length-1);J=J.j[R];Q.call(r,ya,sa,g,J)}y=h.u;r=h.canvas;w=r.width;J=r.height;R=r.length;var t=new Uint16Array(w*J*R);if(1E100===r.v)r=[t,0];else{Q=0;for(let ya=0,sa=0;ya<J;ya++)for(var Z=0;Z<R;Z++)for(var ca=0;ca<w;ca++,sa++){const g=r.get(r.v+ca,r.B+ya,r.C+Z);0!==g&&Q++;t[sa]=g}r=[t,Q]}const [Ga,Ha]=r;r=h.canvas.i;w=Math.max(Math.ceil(Math.log2(h.i.length)),2);Q=new DataView(new ArrayBuffer(8*Math.ceil(Ga.length*w/64)));R=J=0n;Z=t=0;for(var oa of Ga)ca=
BigInt(oa)<<BigInt(t),J|=ca,R|=ca>>64n,t+=w,64<=t&&(t-=64,Q.setBigUint64(Z,J),Z+=8,J=R,R=0n);oa=BigInt(Date.now());h={Version:h.version,MinecraftDataVersion:2730,Metadata:{Name:h.name,Author:"russellsprouts",Description:h.description,TimeCreated:oa,TimeModified:oa,TotalBlocks:Ha,TotalVolume:h.canvas.width*h.canvas.height*h.canvas.length,RegionCount:1,EnclosingSize:{x:h.canvas.width,y:h.canvas.height,z:h.canvas.length}},Regions:{[h.name]:{BlockStatePalette:h.i.map(ma),BlockStates:Q,Position:{x:r.v,
y:r.B,z:r.C},Size:{x:h.canvas.width,y:h.canvas.height,z:h.canvas.length},Entities:[],PendingBlockTicks:[],TileEntities:[]}}};oa=y.i;r=new nb;wb(h,"root");jb(r,10);lb(r,"");xb(y,r,h,oa,"root");h=new DataView(r.data.buffer,0,r.i);h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength);h=ia.gzip(h);x(h,"geode-farm-export.litematic")}};
//# sourceMappingURL=main.js.map
